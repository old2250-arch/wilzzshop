<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Deposit API</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body { padding: 20px; background-color: #f8f9fa; }
        .container { max-width: 500px; margin: 50px auto; background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; margin-bottom: 30px; color: #0d6efd; }
        .form-label { font-weight: 500; }
        .btn-primary { width: 100%; padding: 10px; font-size: 1.1em; }
        .result-box { margin-top: 20px; padding: 15px; border: 1px solid #dee2e6; border-radius: 8px; background-color: #e9ecef; }
        .result-box pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Test Deposit API Backend</h1>
        <form id="testForm">
            <div class="mb-3">
                <label for="testNominal" class="form-label">Nominal Deposit</label>
                <input type="number" class="form-control" id="testNominal" name="nominal" placeholder="Masukkan nominal (misal: 10000)" required>
            </div>
            <button type="submit" class="btn btn-primary">Kirim ke Backend</button>
        </form>
        
        <div id="responseResult" class="result-box" style="display: none;">
            <h2>Respons dari Backend:</h2>
            <pre id="responseData"></pre>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const testForm = document.getElementById('testForm');
        const testNominalInput = document.getElementById('testNominal');
        const responseResultDiv = document.getElementById('responseResult');
        const responseDataPre = document.getElementById('responseData');

        testForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const nominalValue = testNominalInput.value;

            if (!nominalValue || isNaN(nominalValue) || parseInt(nominalValue) <= 0) {
                alert('Harap masukkan nominal deposit yang valid (angka positif).');
                return;
            }

            // Data yang akan dikirim ke backend
            const depositData = {
                nominal: parseInt(nominalValue),
                // Kita akan mengirim metode sebagai null atau undefined untuk tes ini
                // agar kita bisa melihat bagaimana backend menanganinya tanpa metode.
                // Jika backend Anda butuh metode dummy, Anda bisa tambahkan di sini.
                // contoh: metode: "TEST_METHOD"
                metode: "QRISFAST" // Backend Anda memfilter berdasarkan metode, jadi kita perlu mengirimkan sesuatu
                                      // Jika Anda ingin tes tanpa metode, sesuaikan backendnya untuk mengizinkan undefined/null
            };

            responseResultDiv.style.display = 'block';
            responseDataPre.textContent = 'Mengirim permintaan...';

            try {
                const response = await fetch('/api/webtrx/deposit/create', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        // Jika otentikasi menggunakan token atau header custom, tambahkan di sini
                    },
                    body: JSON.stringify(depositData)
                });

                const data = await response.json();
                responseDataPre.textContent = JSON.stringify(data, null, 2); // Tampilkan respons dalam format pretty print

                if (!response.ok) {
                    console.error('Error response:', data);
                }

            } catch (error) {
                console.error('Fetch error:', error);
                responseDataPre.textContent = `Terjadi kesalahan saat request: ${error.message}`;
            }
        });
    </script>
</body>
</html>